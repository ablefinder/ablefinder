function playVideo(e){if(video=$(e).find("video").get(0),!video)return!0;0<video.currentTime&&!video.paused&&!video.ended&&2<video.readyState||video.play()}function pauseVideo(e){if(video=$(e).find("video").get(0),!video)return!0;0<video.currentTime&&!video.paused&&!video.ended&&2<video.readyState&&video.pause()}function onScroll(e){var t=$(document).scrollTop();$("#secondNav li a").each(function(){var e=$(this),o=$(e.attr("href"));o.position().top-200<=t&&o.position().top+o.height()>t?(e.not(".active")&&($("#secondNav li a").removeClass("active"),e.addClass("active"),(e.offset().left<0||e.offset().left>$(window).width()-50)&&$("#secondNav").animate({scrollLeft:e.offset().left},300)),playVideo(o)):(e.removeClass("active"),pauseVideo(o))})}$(document).ready(function(){$("#nav-icon").click(function(){$(this).toggleClass("open"),$("#sidebarNav").toggleClass("open"),$("#PageOverlay").toggleClass("open"),$("body").toggleClass("open")}),$(document).on("scroll",onScroll),$('a[href^="#"]').on("click",function(e){e.preventDefault(),$("a").each(function(){$(this).removeClass("active")}),$(this).addClass("active");var o=this.hash,t=$(o);t.length&&$("html, body").stop().animate({scrollTop:t.offset().top},500,"swing",function(){window.location.hash=o})});var o=$(window).scrollTop();if($(window).scroll(function(){var e=$(this).scrollTop();e<0&&(e=0),o<e?$(".header, body").addClass("fixed"):$(".header, body").removeClass("fixed"),o=e}),$("#ourHistory").length){function n(e){return Math.round(e/50)}var e=$("#ourHistory .owl-carousel .carousel-content").length,a=$('#ourHistory input[type="range"]'),t=$("#ourHistory .owl-carousel"),i=!1,s=50*(e-1);t.on("changed.owl.carousel initialized.owl.carousel",function(e){if(e.item){var o=e.item.index,t=e.item.count;t<=o?o-=t:o<0&&(o+=t),console.log("scrollto",o),n(a.val())==o||i||function(e){var o=50*e;o<0&&(o=0),s<o&&(o=s),$({val:a.val()}).animate({val:50*e},{duration:300,easing:"linear",step:function(e){a.val(Math.ceil(e))}})}(o)}}),t.owlCarousel({loop:!1,margin:24,responsiveClass:!0,dots:!1,startPosition:1,responsive:{0:{items:1,nav:!0},500:{items:2,nav:!0},768:{items:3,nav:!0},980:{items:4,nav:!0}}}),a.prop("min",0),a.val(100),a.prop("max",s),a.on("change input",function(e){t.trigger("to.owl.carousel",[n($(this).val()),300])}),a.on("mousedown",function(e){i=!0}),a.on("mouseup",function(e){i=!1}),setTimeout(function(){t.trigger("to.owl.carousel",[e,1])},1)}function l(){$(".show-modal").removeClass("show-modal"),$("body").removeClass("no-scroll")}$(".trigger").on("click",function(){return function(e){console.log("modal open ",e);var o=$("#"+e);o.length&&($("body").addClass("no-scroll"),o.addClass("show-modal"))}($(this).data("target")),!1}),$(".close-button").on("click",function(){l()}),$("body").on("click",function(e){$(e.target).is(".modal")&&l()}),$('select[name="country_id"]').length&&$.get("/countries.json").done(function(e){$('select[name="country_id"]').each(function(){var t=$(this);$.each(e,function(e,o){t.append($("<option />").val(e).text(o))})})}),$("select").on("blur",function(){$(this).attr("value",$(this).val())})}),$(document).ready(function(){$("#modalFeedback form").on("submit",function(){var t=$(this);return t.find(".field").removeClass("error-block"),$.post(window.URL_FORM_FEEDBACK,$(this).serialize()).done(function(e){$("#modalFeedback .modal-header").html(""),$("#modalFeedback .modal-content").html('<p class="finish-text">Thank you for your feedback!</p>')}).fail(function(e){e.responseJSON&&$.each(e.responseJSON,function(e,o){t.find('[name="'+e+'"]').closest(".field").addClass("error-block").find("p").text(o.join(", "))})}),!1}),$("#modalStory form").on("submit",function(){var t=$(this);return t.find(".field").removeClass("error-block"),$.post(window.URL_FORM_STORY,$(this).serialize()).done(function(e){$("#modalStory .modal-header").html(""),$("#modalStory .modal-content").html('<p class="finish-text">Тhank you, your story has been sent!</p>')}).fail(function(e){e.responseJSON&&$.each(e.responseJSON,function(e,o){t.find('[name="'+e+'"]').closest(".field").addClass("error-block").find("p").text(o.join(", "))})}),!1}),$("#modalContact form").on("submit",function(){var t=$(this);return t.find(".field").removeClass("error-block"),$.post(window.URL_FORM_CONTACT,$(this).serialize()).done(function(e){$("#modalContact .modal-header").html(""),$("#modalContact .modal-content").html('<p class="finish-text">Тhank you, your story has been sent!</p>')}).fail(function(e){e.responseJSON&&$.each(e.responseJSON,function(e,o){t.find('[name="'+e+'"]').closest(".field").addClass("error-block").find("p").text(o.join(", "))})}),!1})}),$(document).ready(function(){size_li=$(".inf_scroll .inf_wrap").length,x=10,$(".inf_scroll .inf_wrap:lt("+x+")").fadeIn(),$("#loadMore").click(function(){x=x+10<=size_li?x+10:size_li,$(".inf_scroll .inf_wrap:lt("+x+")").fadeIn(),$(this).toggle(x<size_li)});document.addEventListener("invalid",function(e){$(e.target).addClass("invalid"),$("html, body").animate({scrollTop:$($(".invalid")[0]).offset().top-150},0)},!0),document.addEventListener("change",function(e){$(e.target).removeClass("invalid")},!0)}),$(document).ready(function(){var t="Read more";$(".more").each(function(){var e=$(this).html();if(327<e.length){var o=e.substr(0,327)+'<span class="moreellipses">...&nbsp;</span><span class="morecontent"><span>'+e.substr(327,e.length-327)+'</span><a href="" class="morelink">'+t+"</a></span>";$(this).html(o)}}),$(".morelink").click(function(){return $(this).hasClass("less")?($(this).removeClass("less"),$(this).html(t)):($(this).addClass("less"),$(this).html("Hide")),$(this).parent().prev().toggle(),$(this).prev().toggle(),!1})}),$(document).ready(function(){var e,o;$(".expand_all_toggle").on("click",function(){$(this).hasClass("open")?($(".acc_content").slideUp(),$(this).removeClass("open"),$(this).text("Expand all"),$(".acc_toggle").removeClass("active")):($(this).text("Collapse all"),$(".acc_content").slideDown(),$(this).addClass("open"),$(".acc_toggle").addClass("active"))}),e=jQuery,o=e(".acc_wrapper .acc_content").hide(),e(".acc_wrapper .acc_toggle.first").next().addClass("active").slideDown(),e(".acc_wrapper .acc_toggle").click(function(){return $this=e(this),$target=$this.next(),$target.hasClass("active")?($this.removeClass("active"),$target.removeClass("active").slideUp()):(o.removeClass("active").slideUp(),$this.addClass("active"),$target.addClass("active").slideDown()),!1})});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1haW4uanMiXSwibmFtZXMiOlsicGxheVZpZGVvIiwiaG9sZGVyIiwidmlkZW8iLCIkIiwiZmluZCIsImdldCIsImN1cnJlbnRUaW1lIiwicGF1c2VkIiwiZW5kZWQiLCJyZWFkeVN0YXRlIiwicGxheSIsInBhdXNlVmlkZW8iLCJwYXVzZSIsIm9uU2Nyb2xsIiwiZXZlbnQiLCJzY3JvbGxQb3MiLCJkb2N1bWVudCIsInNjcm9sbFRvcCIsImVhY2giLCJjdXJyTGluayIsInRoaXMiLCJyZWZFbGVtZW50IiwiYXR0ciIsInBvc2l0aW9uIiwidG9wIiwiaGVpZ2h0Iiwibm90IiwicmVtb3ZlQ2xhc3MiLCJhZGRDbGFzcyIsIm9mZnNldCIsImxlZnQiLCJ3aW5kb3ciLCJ3aWR0aCIsImFuaW1hdGUiLCJzY3JvbGxMZWZ0IiwicmVhZHkiLCJjbGljayIsInRvZ2dsZUNsYXNzIiwib24iLCJlIiwicHJldmVudERlZmF1bHQiLCJ0YXJnZXQiLCJoYXNoIiwiJHRhcmdldCIsImxlbmd0aCIsInN0b3AiLCJsb2NhdGlvbiIsImxhc3RTY3JvbGxUb3AiLCJzY3JvbGwiLCJzdCIsInJhbmdlVmFsVG9JbmRleCIsImlucHV0IiwiTWF0aCIsInJvdW5kIiwib3dsSXRlbUNvdW50IiwiJHJhbmdlSW5wdXQiLCIkb3dsQ29udGFpbmVyIiwicmFuZ2VUb3VjaGVkIiwicmFuZ2VNYXgiLCJpdGVtIiwiaW5kZXgiLCJjb3VudCIsImNvbnNvbGUiLCJsb2ciLCJ2YWwiLCJ0byIsImR1cmF0aW9uIiwiZWFzaW5nIiwic3RlcCIsImNlaWwiLCJyYW5nZVNjcm9sbFRvIiwib3dsQ2Fyb3VzZWwiLCJsb29wIiwibWFyZ2luIiwicmVzcG9uc2l2ZUNsYXNzIiwiZG90cyIsInN0YXJ0UG9zaXRpb24iLCJyZXNwb25zaXZlIiwiMCIsIml0ZW1zIiwibmF2IiwiNTAwIiwiNzY4IiwiOTgwIiwicHJvcCIsInRyaWdnZXIiLCJzZXRUaW1lb3V0IiwibW9kYWxDbG9zZUFsbCIsImlkIiwiJG1vZGFsIiwibW9kYWxPcGVuIiwiZGF0YSIsImlzIiwiZG9uZSIsInJlc3VsdCIsIiR0aGlzIiwia2V5IiwidmFsdWUiLCJhcHBlbmQiLCJ0ZXh0IiwiJGZvcm0iLCJwb3N0IiwiVVJMX0ZPUk1fRkVFREJBQ0siLCJzZXJpYWxpemUiLCJodG1sIiwiZmFpbCIsInJlc3BvbnNlSlNPTiIsImNsb3Nlc3QiLCJqb2luIiwiVVJMX0ZPUk1fU1RPUlkiLCJVUkxfRk9STV9DT05UQUNUIiwic2l6ZV9saSIsIngiLCJmYWRlSW4iLCJ0b2dnbGUiLCJhZGRFdmVudExpc3RlbmVyIiwibW9yZXRleHQiLCJjb250ZW50Iiwic3Vic3RyIiwiaGFzQ2xhc3MiLCJwYXJlbnQiLCJwcmV2IiwiYWxsUGFuZWxzIiwic2xpZGVVcCIsInNsaWRlRG93biIsImpRdWVyeSIsImhpZGUiLCJuZXh0Il0sIm1hcHBpbmdzIjoiQUFtTEEsU0FBU0EsVUFBVUMsR0FFakIsR0FEQUMsTUFBUUMsRUFBRUYsR0FBUUcsS0FBSyxTQUFTQyxJQUFJLElBQy9CSCxNQUNILE9BQU8sRUFFMkIsRUFBcEJBLE1BQU1JLGNBQW9CSixNQUFNSyxTQUFXTCxNQUFNTSxPQUE0QixFQUFuQk4sTUFBTU8sWUFFOUVQLE1BQU1RLE9BSVYsU0FBU0MsV0FBV1YsR0FFbEIsR0FEQUMsTUFBUUMsRUFBRUYsR0FBUUcsS0FBSyxTQUFTQyxJQUFJLElBQy9CSCxNQUNILE9BQU8sRUFDMkIsRUFBcEJBLE1BQU1JLGNBQW9CSixNQUFNSyxTQUFXTCxNQUFNTSxPQUE0QixFQUFuQk4sTUFBTU8sWUFFOUVQLE1BQU1VLFFBSVYsU0FBU0MsU0FBU0MsR0FDaEIsSUFBSUMsRUFBWVosRUFBRWEsVUFBVUMsWUFDNUJkLEVBQUUsbUJBQW1CZSxLQUFLLFdBQ3hCLElBQUlDLEVBQVdoQixFQUFFaUIsTUFDYkMsRUFBYWxCLEVBQUVnQixFQUFTRyxLQUFLLFNBRTdCRCxFQUFXRSxXQUFXQyxJQUFJLEtBQU9ULEdBQWFNLEVBQVdFLFdBQVdDLElBQU1ILEVBQVdJLFNBQVdWLEdB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TUFBTW5FLFNBQVMsVUFDZmUsUUFBUWYsU0FBUyxVQUFVZ0csY0FFeEIiLCJmaWxlIjoibWFpbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIiQoZG9jdW1lbnQpLnJlYWR5KGZ1bmN0aW9uICgpIHtcclxuICAkKCcjbmF2LWljb24nKS5jbGljayhmdW5jdGlvbigpe1xyXG4gICAgJCh0aGlzKS50b2dnbGVDbGFzcygnb3BlbicpO1xyXG4gICAgJCgnI3NpZGViYXJOYXYnKS50b2dnbGVDbGFzcygnb3BlbicpO1xyXG4gICAgJCgnI1BhZ2VPdmVybGF5JykudG9nZ2xlQ2xhc3MoJ29wZW4nKTtcclxuICAgICQoJ2JvZHknKS50b2dnbGVDbGFzcygnb3BlbicpO1xyXG4gIH0pO1xyXG4gICQoZG9jdW1lbnQpLm9uKCdzY3JvbGwnLCBvblNjcm9sbCk7XHJcblxyXG4gICQoJ2FbaHJlZl49XCIjXCJdJykub24oJ2NsaWNrJywgZnVuY3Rpb24gKGUpIHtcclxuICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuLy8gICQoZG9jdW1lbnQpLm9mZignc2Nyb2xsJyk7XHJcblxyXG4gICAgJCgnYScpLmVhY2goZnVuY3Rpb24gKCkge1xyXG4gICAgICAkKHRoaXMpLnJlbW92ZUNsYXNzKCdhY3RpdmUnKTtcclxuICAgIH0pO1xyXG4gICAgJCh0aGlzKS5hZGRDbGFzcygnYWN0aXZlJyk7XHJcblxyXG4gICAgdmFyIHRhcmdldCA9IHRoaXMuaGFzaCxcclxuICAgICR0YXJnZXQgPSAkKHRhcmdldCk7XHJcbiAgICBpZiAoJHRhcmdldC5sZW5ndGgpIHtcclxuICAgICAgJCgnaHRtbCwgYm9keScpLnN0b3AoKS5hbmltYXRlKHtcclxuICAgICAgICAnc2Nyb2xsVG9wJzogJHRhcmdldC5vZmZzZXQoKS50b3BcclxuICAgICAgfSwgNTAwLCAnc3dpbmcnLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgd2luZG93LmxvY2F0aW9uLmhhc2ggPSB0YXJnZXQ7XHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICB9KTtcclxuXHJcbiAgdmFyIGxhc3RTY3JvbGxUb3AgPSAkKHdpbmRvdykuc2Nyb2xsVG9wKCk7XHJcblxyXG4gICQod2luZG93KS5zY3JvbGwoZnVuY3Rpb24oKXtcclxuICAgIHZhciBzdCA9ICQodGhpcykuc2Nyb2xsVG9wKCk7XHJcbiAgICBpZiAoc3QgPCAwKVxyXG4gICAgICBzdCA9IDA7XHJcbi8vICAgIGlmIChzdCA+IG1heFNjcm9sbFRvcCkgLy8gJChkb2N1bWVudCkuaGVpZ2h0KClcclxuLy8gICAgICBzdCA9IG1heFNjcm9sbFRvcDtcclxuICAgIGlmIChzdCA+IGxhc3RTY3JvbGxUb3Ape1xyXG4gICAgICAkKCcuaGVhZGVyLCBib2R5JykuYWRkQ2xhc3MoJ2ZpeGVkJyk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAkKCcuaGVhZGVyLCBib2R5JykucmVtb3ZlQ2xhc3MoJ2ZpeGVkJyk7XHJcbiAgICB9XHJcbiAgICBsYXN0U2Nyb2xsVG9wID0gc3Q7XHJcbiAgfSk7XHJcblxyXG4gIGlmICgkKCcjb3VySGlzdG9yeScpLmxlbmd0aCkge1xyXG4gICAgdmFyIG93bEl0ZW1Db3VudCA9ICQoJyNvdXJIaXN0b3J5IC5vd2wtY2Fyb3VzZWwgLmNhcm91c2VsLWNvbnRlbnQnKS5sZW5ndGg7XHJcbiAgICB2YXIgJHJhbmdlSW5wdXQgPSAkKCcjb3VySGlzdG9yeSBpbnB1dFt0eXBlPVwicmFuZ2VcIl0nKTtcclxuICAgIHZhciAkb3dsQ29udGFpbmVyID0gJCgnI291ckhpc3RvcnkgLm93bC1jYXJvdXNlbCcpO1xyXG4gICAgdmFyIHJhbmdlQ29lZiA9IDUwO1xyXG4gICAgdmFyIHJhbmdlVG91Y2hlZCA9IGZhbHNlO1xyXG4gICAgdmFyIHJhbmdlTWF4ID0gKG93bEl0ZW1Db3VudC0xKSpyYW5nZUNvZWY7XHJcbiAgICB2YXIgcmFuZ2VNaW4gPSAwOy8vMSpyYW5nZUNvZWY7XHJcbiAgICB2YXIgcmFuZ2VWYWxUb0luZGV4ID0gZnVuY3Rpb24oaW5wdXQpIHtcclxuICAgICAgcmV0dXJuIE1hdGgucm91bmQoaW5wdXQgLyByYW5nZUNvZWYpO1xyXG4gICAgfVxyXG4gICAgdmFyIHJhbmdlU2Nyb2xsVG8gPSBmdW5jdGlvbihpbmRleCkge1xyXG4gICAgICB2YXIgdG8gPSBpbmRleCpyYW5nZUNvZWY7XHJcbiAgICAgIGlmICh0byA8IHJhbmdlTWluKVxyXG4gICAgICAgIHRvID0gcmFuZ2VNaW47XHJcbiAgICAgIGlmICh0byA+IHJhbmdlTWF4KVxyXG4gICAgICAgIHRvID0gcmFuZ2VNYXg7XHJcbiAgICAgICQoeyB2YWw6ICRyYW5nZUlucHV0LnZhbCgpIH0pLmFuaW1hdGUoeyB2YWw6IGluZGV4KnJhbmdlQ29lZiB9LCB7XHJcbiAgICAgICAgICBkdXJhdGlvbjogMzAwLFxyXG4gICAgICAgICAgZWFzaW5nOiAnbGluZWFyJyxcclxuICAgICAgICAgIHN0ZXA6IGZ1bmN0aW9uKHZhbCkge1xyXG4gICAgICAgICAgICAkcmFuZ2VJbnB1dC52YWwoTWF0aC5jZWlsKHZhbCkpO1xyXG4gICAgICAgICAgfVxyXG4gICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICAkb3dsQ29udGFpbmVyLm9uKCdjaGFuZ2VkLm93bC5jYXJvdXNlbCBpbml0aWFsaXplZC5vd2wuY2Fyb3VzZWwnLCBmdW5jdGlvbihlKSB7XHJcbiAgICAgIGlmIChlLml0ZW0pIHtcclxuICAgICAgICAgIHZhciBpbmRleCA9IGUuaXRlbS5pbmRleDtcclxuICAgICAgICAgIHZhciBjb3VudCA9IGUuaXRlbS5jb3VudDtcclxuICAgICAgICAgIGlmIChpbmRleCA+PSBjb3VudCkge1xyXG4gICAgICAgICAgICAgIGluZGV4ID0gaW5kZXggLSBjb3VudDtcclxuICAgICAgICAgIH0gZWxzZSBpZiAoaW5kZXggPCAwKSB7XHJcbiAgICAgICAgICAgICAgaW5kZXggPSBpbmRleCArIGNvdW50O1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgY29uc29sZS5sb2coJ3Njcm9sbHRvJywgaW5kZXgpO1xyXG4gICAgICAgICAgaWYgKChyYW5nZVZhbFRvSW5kZXgoJHJhbmdlSW5wdXQudmFsKCkpICE9IGluZGV4KSAmJiAoIXJhbmdlVG91Y2hlZCkpe1xyXG4gICAgICAgICAgICByYW5nZVNjcm9sbFRvKGluZGV4KTtcclxuICAgICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfSk7XHJcblxyXG4gICAgJG93bENvbnRhaW5lci5vd2xDYXJvdXNlbCh7XHJcbiAgICAgICAgbG9vcDpmYWxzZSxcclxuICAgICAgICBtYXJnaW46MjQsXHJcbiAgICAgICAgcmVzcG9uc2l2ZUNsYXNzOnRydWUsXHJcbiAgICAgICAgZG90czpmYWxzZSxcclxuLy8gICAgICAgIGNlbnRlcjogdHJ1ZSxcclxuICAgICAgICBzdGFydFBvc2l0aW9uOiAxLFxyXG4gICAgICAgIHJlc3BvbnNpdmU6e1xyXG4gICAgICAgICAgMDp7XHJcbiAgICAgICAgICAgIGl0ZW1zOjEsXHJcbiAgICAgICAgICAgIG5hdjp0cnVlXHJcbiAgICAgICAgICB9LFxyXG4gICAgICAgICAgNTAwOntcclxuICAgICAgICAgICAgaXRlbXM6MixcclxuICAgICAgICAgICAgbmF2OnRydWVcclxuICAgICAgICAgIH0sXHJcbiAgICAgICAgICA3Njg6e1xyXG4gICAgICAgICAgICBpdGVtczozLFxyXG4gICAgICAgICAgICBuYXY6dHJ1ZVxyXG4gICAgICAgICAgfSxcclxuICAgICAgICAgIDk4MDp7XHJcbiAgICAgICAgICAgIGl0ZW1zOjQsXHJcbiAgICAgICAgICAgIG5hdjp0cnVlXHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICB9KTtcclxuXHJcbiAgICAkcmFuZ2VJbnB1dC5wcm9wKCdtaW4nLCByYW5nZU1pbik7XHJcbiAgICAkcmFuZ2VJbnB1dC52YWwoMipyYW5nZUNvZWYpO1xyXG4gICAgJHJhbmdlSW5wdXQucHJvcCgnbWF4JywgcmFuZ2VNYXgpO1xyXG5cclxuICAgICRyYW5nZUlucHV0Lm9uKCdjaGFuZ2UgaW5wdXQnLCBmdW5jdGlvbihlKSB7XHJcbiAgICAgICRvd2xDb250YWluZXIudHJpZ2dlcigndG8ub3dsLmNhcm91c2VsJywgW3JhbmdlVmFsVG9JbmRleCgkKHRoaXMpLnZhbCgpKSwgMzAwIF0pO1xyXG4gICAgfSk7XHJcbiAgICAkcmFuZ2VJbnB1dC5vbignbW91c2Vkb3duJywgZnVuY3Rpb24oZSkge1xyXG4gICAgICByYW5nZVRvdWNoZWQgPSB0cnVlO1xyXG4gICAgfSk7XHJcbiAgICAkcmFuZ2VJbnB1dC5vbignbW91c2V1cCcsIGZ1bmN0aW9uKGUpIHtcclxuICAgICAgcmFuZ2VUb3VjaGVkID0gZmFsc2U7XHJcbiAgICB9KTtcclxuXHJcbiAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xyXG4gICAgICAkb3dsQ29udGFpbmVyLnRyaWdnZXIoJ3RvLm93bC5jYXJvdXNlbCcsIFtvd2xJdGVtQ291bnQsIDEgXSk7XHJcbiAgICB9LCAxKTtcclxuXHJcbiAgfVxyXG5cclxuXHJcbiAgdmFyIG1vZGFsQ2xvc2VBbGwgPSBmdW5jdGlvbigpIHtcclxuICAgICQoJy5zaG93LW1vZGFsJykucmVtb3ZlQ2xhc3MoJ3Nob3ctbW9kYWwnKTtcclxuICAgICQoJ2JvZHknKS5yZW1vdmVDbGFzcygnbm8tc2Nyb2xsJyk7XHJcbiAgfVxyXG5cclxuICB2YXIgbW9kYWxPcGVuID0gZnVuY3Rpb24oaWQpIHtcclxuICAgIGNvbnNvbGUubG9nKCdtb2RhbCBvcGVuICcsIGlkKTtcclxuICAgIHZhciAkbW9kYWwgPSAkKCcjJyArIGlkKTtcclxuICAgIGlmICgkbW9kYWwubGVuZ3RoKSB7XHJcbiAgICAgICQoJ2JvZHknKS5hZGRDbGFzcygnbm8tc2Nyb2xsJyk7XHJcbiAgICAgICRtb2RhbC5hZGRDbGFzcygnc2hvdy1tb2RhbCcpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgJCgnLnRyaWdnZXInKS5vbignY2xpY2snLCBmdW5jdGlvbigpIHtcclxuICAgIG1vZGFsT3BlbigkKHRoaXMpLmRhdGEoJ3RhcmdldCcpKTtcclxuICAgIHJldHVybiBmYWxzZTtcclxuICB9KTtcclxuXHJcbiAgJCgnLmNsb3NlLWJ1dHRvbicpLm9uKCdjbGljaycsIGZ1bmN0aW9uKCkge1xyXG4gICAgbW9kYWxDbG9zZUFsbCgpO1xyXG4gIH0pO1xyXG4gICQoJ2JvZHknKS5vbignY2xpY2snLCBmdW5jdGlvbihlKSB7XHJcbiAgICBpZiAoJChlLnRhcmdldCkuaXMoJy5tb2RhbCcpKSB7XHJcbiAgICAgIG1vZGFsQ2xvc2VBbGwoKTtcclxuICAgIH1cclxuICB9KTtcclxuXHJcbiAgaWYgKCQoJ3NlbGVjdFtuYW1lPVwiY291bnRyeV9pZFwiXScpLmxlbmd0aCkge1xyXG4gICAgJC5nZXQoJy9jb3VudHJpZXMuanNvbicpLmRvbmUoZnVuY3Rpb24ocmVzdWx0KSB7XHJcbiAgICAgICQoJ3NlbGVjdFtuYW1lPVwiY291bnRyeV9pZFwiXScpLmVhY2goZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgdmFyICR0aGlzID0gJCh0aGlzKTtcclxuICAgICAgICAkLmVhY2gocmVzdWx0LCBmdW5jdGlvbihrZXksIHZhbHVlKSB7XHJcbiAgICAgICAgICAkdGhpcy5hcHBlbmQoJChcIjxvcHRpb24gLz5cIikudmFsKGtleSkudGV4dCh2YWx1ZSkpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICB9KTtcclxuICAgIH0pO1xyXG4gIH1cclxuICAkKCdzZWxlY3QnKS5vbignYmx1cicsIGZ1bmN0aW9uKCkge1xyXG4gICAgJCh0aGlzKS5hdHRyKCd2YWx1ZScsICQodGhpcykudmFsKCkpO1xyXG4gIH0pO1xyXG4gfSk7XHJcblxyXG5mdW5jdGlvbiBwbGF5VmlkZW8oaG9sZGVyKSB7XHJcbiAgdmlkZW8gPSAkKGhvbGRlcikuZmluZCgndmlkZW8nKS5nZXQoMCk7XHJcbiAgaWYgKCF2aWRlbylcclxuICAgIHJldHVybiB0cnVlO1xyXG5cclxuICB2YXIgaXNQbGF5aW5nID0gdmlkZW8uY3VycmVudFRpbWUgPiAwICYmICF2aWRlby5wYXVzZWQgJiYgIXZpZGVvLmVuZGVkICYmIHZpZGVvLnJlYWR5U3RhdGUgPiAyO1xyXG4gIGlmICghaXNQbGF5aW5nKSB7XHJcbiAgICB2aWRlby5wbGF5KCk7XHJcbiAgfVxyXG59XHJcblxyXG5mdW5jdGlvbiBwYXVzZVZpZGVvKGhvbGRlcikge1xyXG4gIHZpZGVvID0gJChob2xkZXIpLmZpbmQoJ3ZpZGVvJykuZ2V0KDApO1xyXG4gIGlmICghdmlkZW8pXHJcbiAgICByZXR1cm4gdHJ1ZTtcclxuICB2YXIgaXNQbGF5aW5nID0gdmlkZW8uY3VycmVudFRpbWUgPiAwICYmICF2aWRlby5wYXVzZWQgJiYgIXZpZGVvLmVuZGVkICYmIHZpZGVvLnJlYWR5U3RhdGUgPiAyO1xyXG4gIGlmIChpc1BsYXlpbmcpIHtcclxuICAgIHZpZGVvLnBhdXNlKCk7XHJcbiAgfVxyXG59XHJcblxyXG5mdW5jdGlvbiBvblNjcm9sbChldmVudCkge1xyXG4gIHZhciBzY3JvbGxQb3MgPSAkKGRvY3VtZW50KS5zY3JvbGxUb3AoKTtcclxuICAkKCcjc2Vjb25kTmF2IGxpIGEnKS5lYWNoKGZ1bmN0aW9uICgpIHtcclxuICAgIHZhciBjdXJyTGluayA9ICQodGhpcyk7XHJcbiAgICB2YXIgcmVmRWxlbWVudCA9ICQoY3VyckxpbmsuYXR0cignaHJlZicpKTtcclxuICAgIHZhciB2aWRlbyA9IG51bGw7XHJcbiAgICBpZiAocmVmRWxlbWVudC5wb3NpdGlvbigpLnRvcC0yMDAgPD0gc2Nyb2xsUG9zICYmIHJlZkVsZW1lbnQucG9zaXRpb24oKS50b3AgKyByZWZFbGVtZW50LmhlaWdodCgpID4gc2Nyb2xsUG9zKSB7XHJcbiAgICAgIGlmIChjdXJyTGluay5ub3QoJy5hY3RpdmUnKSkge1xyXG4gICAgICAgICQoJyNzZWNvbmROYXYgbGkgYScpLnJlbW92ZUNsYXNzKCdhY3RpdmUnKTtcclxuICAgICAgICBjdXJyTGluay5hZGRDbGFzcygnYWN0aXZlJyk7XHJcbiAgICAgICAgaWYgKChjdXJyTGluay5vZmZzZXQoKS5sZWZ0IDwgMCkgfHwgKGN1cnJMaW5rLm9mZnNldCgpLmxlZnQgPiAoJCh3aW5kb3cpLndpZHRoKCkgLSA1MCkgKSlcclxuICAgICAgICAgICQoJyNzZWNvbmROYXYnKS5hbmltYXRlKCB7IHNjcm9sbExlZnQgOiBjdXJyTGluay5vZmZzZXQoKS5sZWZ0IH0sIDMwMCApO1xyXG4gICAgICB9XHJcbiAgICAgIHBsYXlWaWRlbyhyZWZFbGVtZW50KTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIGN1cnJMaW5rLnJlbW92ZUNsYXNzKCdhY3RpdmUnKTtcclxuICAgICAgcGF1c2VWaWRlbyhyZWZFbGVtZW50KTtcclxuICAgIH1cclxuICB9KTtcclxufVxyXG5cclxuXHJcbi8qZm9ybXMqL1xyXG4kKGRvY3VtZW50KS5yZWFkeShmdW5jdGlvbigpIHtcclxuICAkKCcjbW9kYWxGZWVkYmFjayBmb3JtJykub24oJ3N1Ym1pdCcsIGZ1bmN0aW9uKCkge1xyXG4gICAgdmFyICRmb3JtID0gJCh0aGlzKTtcclxuICAgICRmb3JtLmZpbmQoJy5maWVsZCcpLnJlbW92ZUNsYXNzKCdlcnJvci1ibG9jaycpO1xyXG4gICAgJC5wb3N0KHdpbmRvdy5VUkxfRk9STV9GRUVEQkFDSywgJCh0aGlzKS5zZXJpYWxpemUoKSkuZG9uZShmdW5jdGlvbihkb25lKSB7XHJcbiAgICAgICAgJCgnI21vZGFsRmVlZGJhY2sgLm1vZGFsLWhlYWRlcicpLmh0bWwoJycpO1xyXG4gICAgICAgICQoJyNtb2RhbEZlZWRiYWNrIC5tb2RhbC1jb250ZW50JykuaHRtbCgnPHAgY2xhc3M9XCJmaW5pc2gtdGV4dFwiPlRoYW5rIHlvdSBmb3IgeW91ciBmZWVkYmFjayE8L3A+Jyk7XHJcbiAgICB9KS5mYWlsKGZ1bmN0aW9uKGZhaWwpIHtcclxuICAgICAgaWYgKGZhaWwucmVzcG9uc2VKU09OKSB7XHJcbiAgICAgICAgJC5lYWNoKGZhaWwucmVzcG9uc2VKU09OLCBmdW5jdGlvbihrZXksIHZhbHVlKSB7XHJcbiAgICAgICAgICAkZm9ybS5maW5kKCdbbmFtZT1cIicra2V5KydcIl0nKS5jbG9zZXN0KCcuZmllbGQnKS5hZGRDbGFzcygnZXJyb3ItYmxvY2snKS5maW5kKCdwJykudGV4dCh2YWx1ZS5qb2luKCcsICcpKTtcclxuICAgICAgICB9KTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgICByZXR1cm4gZmFsc2U7XHJcbiAgfSk7XHJcbiAgJCgnI21vZGFsU3RvcnkgZm9ybScpLm9uKCdzdWJtaXQnLCBmdW5jdGlvbigpIHtcclxuICAgIHZhciAkZm9ybSA9ICQodGhpcyk7XHJcbiAgICAkZm9ybS5maW5kKCcuZmllbGQnKS5yZW1vdmVDbGFzcygnZXJyb3ItYmxvY2snKTtcclxuICAgICQucG9zdCh3aW5kb3cuVVJMX0ZPUk1fU1RPUlksICQodGhpcykuc2VyaWFsaXplKCkpLmRvbmUoZnVuY3Rpb24oZG9uZSkge1xyXG4gICAgICAgICQoJyNtb2RhbFN0b3J5IC5tb2RhbC1oZWFkZXInKS5odG1sKCcnKTtcclxuICAgICAgICAkKCcjbW9kYWxTdG9yeSAubW9kYWwtY29udGVudCcpLmh0bWwoJzxwIGNsYXNzPVwiZmluaXNoLXRleHRcIj7QomhhbmsgeW91LCB5b3VyIHN0b3J5IGhhcyBiZWVuIHNlbnQhPC9wPicpO1xyXG4gICAgfSkuZmFpbChmdW5jdGlvbihmYWlsKSB7XHJcbiAgICAgIGlmIChmYWlsLnJlc3BvbnNlSlNPTikge1xyXG4gICAgICAgICQuZWFjaChmYWlsLnJlc3BvbnNlSlNPTiwgZnVuY3Rpb24oa2V5LCB2YWx1ZSkge1xyXG4gICAgICAgICAgJGZvcm0uZmluZCgnW25hbWU9XCInK2tleSsnXCJdJykuY2xvc2VzdCgnLmZpZWxkJykuYWRkQ2xhc3MoJ2Vycm9yLWJsb2NrJykuZmluZCgncCcpLnRleHQodmFsdWUuam9pbignLCAnKSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gICAgcmV0dXJuIGZhbHNlO1xyXG4gIH0pO1xyXG4gICQoJyNtb2RhbENvbnRhY3QgZm9ybScpLm9uKCdzdWJtaXQnLCBmdW5jdGlvbigpIHtcclxuICAgIHZhciAkZm9ybSA9ICQodGhpcyk7XHJcbiAgICAkZm9ybS5maW5kKCcuZmllbGQnKS5yZW1vdmVDbGFzcygnZXJyb3ItYmxvY2snKTtcclxuICAgICQucG9zdCh3aW5kb3cuVVJMX0ZPUk1fQ09OVEFDVCwgJCh0aGlzKS5zZXJpYWxpemUoKSkuZG9uZShmdW5jdGlvbihkb25lKSB7XHJcbiAgICAgICAgJCgnI21vZGFsQ29udGFjdCAubW9kYWwtaGVhZGVyJykuaHRtbCgnJyk7XHJcbiAgICAgICAgJCgnI21vZGFsQ29udGFjdCAubW9kYWwtY29udGVudCcpLmh0bWwoJzxwIGNsYXNzPVwiZmluaXNoLXRleHRcIj7QomhhbmsgeW91LCB5b3VyIHN0b3J5IGhhcyBiZWVuIHNlbnQhPC9wPicpO1xyXG4gICAgfSkuZmFpbChmdW5jdGlvbihmYWlsKSB7XHJcbiAgICAgIGlmIChmYWlsLnJlc3BvbnNlSlNPTikge1xyXG4gICAgICAgICQuZWFjaChmYWlsLnJlc3BvbnNlSlNPTiwgZnVuY3Rpb24oa2V5LCB2YWx1ZSkge1xyXG4gICAgICAgICAgJGZvcm0uZmluZCgnW25hbWU9XCInK2tleSsnXCJdJykuY2xvc2VzdCgnLmZpZWxkJykuYWRkQ2xhc3MoJ2Vycm9yLWJsb2NrJykuZmluZCgncCcpLnRleHQodmFsdWUuam9pbignLCAnKSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gICAgcmV0dXJuIGZhbHNlO1xyXG4gIH0pO1xyXG59KTtcclxuXHJcbiQoZG9jdW1lbnQpLnJlYWR5KGZ1bmN0aW9uICgpIHtcclxuICBzaXplX2xpID0gJChcIi5pbmZfc2Nyb2xsIC5pbmZfd3JhcFwiKS5sZW5ndGg7XHJcbiAgeCA9IDEwO1xyXG4gICQoJy5pbmZfc2Nyb2xsIC5pbmZfd3JhcDpsdCgnICsgeCArICcpJykuZmFkZUluKCk7XHJcbiAgJCgnI2xvYWRNb3JlJykuY2xpY2soZnVuY3Rpb24gKCkge1xyXG4gICAgeCA9ICh4ICsgMTAgPD0gc2l6ZV9saSkgPyB4ICsgMTAgOiBzaXplX2xpO1xyXG4gICAgJCgnLmluZl9zY3JvbGwgLmluZl93cmFwOmx0KCcgKyB4ICsgJyknKS5mYWRlSW4oKTtcclxuICAgICQodGhpcykudG9nZ2xlKHggPCBzaXplX2xpKTtcclxuICB9KTtcclxuXHJcbiAgdmFyIGRlbGF5ID0gMDtcclxuICB2YXIgb2Zmc2V0ID0gMTUwO1xyXG5cclxuICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdpbnZhbGlkJywgZnVuY3Rpb24gKGUpIHtcclxuICAgICQoZS50YXJnZXQpLmFkZENsYXNzKFwiaW52YWxpZFwiKTtcclxuICAgICQoJ2h0bWwsIGJvZHknKS5hbmltYXRlKHsgc2Nyb2xsVG9wOiAkKCQoXCIuaW52YWxpZFwiKVswXSkub2Zmc2V0KCkudG9wIC0gb2Zmc2V0IH0sIGRlbGF5KTtcclxuICB9LCB0cnVlKTtcclxuICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCBmdW5jdGlvbiAoZSkge1xyXG4gICAgJChlLnRhcmdldCkucmVtb3ZlQ2xhc3MoXCJpbnZhbGlkXCIpXHJcbiAgfSwgdHJ1ZSk7XHJcbn0pO1xyXG5cclxuJChkb2N1bWVudCkucmVhZHkoZnVuY3Rpb24oKSB7XHJcbiAgICAvLyBDb25maWd1cmUvY3VzdG9taXplIHRoZXNlIHZhcmlhYmxlcy5cclxuICAgIHZhciBzaG93Q2hhciA9IDMyNzsgIC8vIEhvdyBtYW55IGNoYXJhY3RlcnMgYXJlIHNob3duIGJ5IGRlZmF1bHRcclxuICAgIHZhciBlbGxpcHNlc3RleHQgPSBcIi4uLlwiO1xyXG4gICAgdmFyIG1vcmV0ZXh0ID0gXCJSZWFkIG1vcmVcIjtcclxuICAgIHZhciBsZXNzdGV4dCA9IFwiSGlkZVwiO1xyXG4gICAgXHJcbiAgICAkKCcubW9yZScpLmVhY2goZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgdmFyIGNvbnRlbnQgPSAkKHRoaXMpLmh0bWwoKTtcclxuICAgICAgICBpZihjb250ZW50Lmxlbmd0aCA+IHNob3dDaGFyKSB7XHJcbiAgICAgICAgICAgIHZhciBjID0gY29udGVudC5zdWJzdHIoMCwgc2hvd0NoYXIpO1xyXG4gICAgICAgICAgICB2YXIgaCA9IGNvbnRlbnQuc3Vic3RyKHNob3dDaGFyLCBjb250ZW50Lmxlbmd0aCAtIHNob3dDaGFyKTtcclxuIFxyXG4gICAgICAgICAgICB2YXIgaHRtbCA9IGMgKyAnPHNwYW4gY2xhc3M9XCJtb3JlZWxsaXBzZXNcIj4nICsgZWxsaXBzZXN0ZXh0KyAnJm5ic3A7PC9zcGFuPjxzcGFuIGNsYXNzPVwibW9yZWNvbnRlbnRcIj48c3Bhbj4nICsgaCArICc8L3NwYW4+PGEgaHJlZj1cIlwiIGNsYXNzPVwibW9yZWxpbmtcIj4nICsgbW9yZXRleHQgKyAnPC9hPjwvc3Bhbj4nO1xyXG4gICAgICAgICAgICAkKHRoaXMpLmh0bWwoaHRtbCk7XHJcbiAgICAgICAgfVxyXG4gICAgfSk7XHJcbiBcclxuICAgICQoXCIubW9yZWxpbmtcIikuY2xpY2soZnVuY3Rpb24oKXtcclxuICAgICAgICBpZigkKHRoaXMpLmhhc0NsYXNzKFwibGVzc1wiKSkge1xyXG4gICAgICAgICAgICAkKHRoaXMpLnJlbW92ZUNsYXNzKFwibGVzc1wiKTtcclxuICAgICAgICAgICAgJCh0aGlzKS5odG1sKG1vcmV0ZXh0KTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAkKHRoaXMpLmFkZENsYXNzKFwibGVzc1wiKTtcclxuICAgICAgICAgICAgJCh0aGlzKS5odG1sKGxlc3N0ZXh0KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgJCh0aGlzKS5wYXJlbnQoKS5wcmV2KCkudG9nZ2xlKCk7XHJcbiAgICAgICAgJCh0aGlzKS5wcmV2KCkudG9nZ2xlKCk7XHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfSk7XHJcbn0pO1xyXG5cclxuJChkb2N1bWVudCkucmVhZHkoZnVuY3Rpb24oKSB7XHJcbiAgJCgnLmV4cGFuZF9hbGxfdG9nZ2xlJykub24oJ2NsaWNrJywgZnVuY3Rpb24oKSB7XHJcbiAgICBpZiAoJCh0aGlzKS5oYXNDbGFzcygnb3BlbicpKSB7XHJcbiAgICAgICQoJy5hY2NfY29udGVudCcpLnNsaWRlVXAoKTtcclxuICAgICAgJCh0aGlzKS5yZW1vdmVDbGFzcygnb3BlbicpO1xyXG4gICAgICAkKHRoaXMpLnRleHQoJ0V4cGFuZCBhbGwnKTtcclxuICAgICAgJCgnLmFjY190b2dnbGUnKS5yZW1vdmVDbGFzcygnYWN0aXZlJyk7XHJcbiAgICB9ZWxzZXtcclxuICAgICAgJCh0aGlzKS50ZXh0KCdDb2xsYXBzZSBhbGwnKTtcclxuICAgICAgJCgnLmFjY19jb250ZW50Jykuc2xpZGVEb3duKCk7XHJcbiAgICAgICQodGhpcykuYWRkQ2xhc3MoJ29wZW4nKTtcclxuICAgICAgJCgnLmFjY190b2dnbGUnKS5hZGRDbGFzcygnYWN0aXZlJyk7XHJcbiAgICB9XHJcbiAgfSk7XHJcbiAgKGZ1bmN0aW9uKCQpIHtcclxuICAgICAgdmFyIGFsbFBhbmVscyA9ICQoJy5hY2Nfd3JhcHBlciAuYWNjX2NvbnRlbnQnKS5oaWRlKCk7XHJcbiAgICAgICQoJy5hY2Nfd3JhcHBlciAuYWNjX3RvZ2dsZS5maXJzdCcpLm5leHQoKS5hZGRDbGFzcygnYWN0aXZlJykuc2xpZGVEb3duKCk7XHJcbiAgICAgICQoJy5hY2Nfd3JhcHBlciAuYWNjX3RvZ2dsZScpLmNsaWNrKGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgJHRoaXMgPSAkKHRoaXMpO1xyXG4gICAgICAgICAgJHRhcmdldCA9ICR0aGlzLm5leHQoKTtcclxuICAgICAgICAgIGlmICgkdGFyZ2V0Lmhhc0NsYXNzKCdhY3RpdmUnKSkge1xyXG4gICAgICAgICAgICAgICR0aGlzLnJlbW92ZUNsYXNzKCdhY3RpdmUnKTtcclxuICAgICAgICAgICAgICAkdGFyZ2V0LnJlbW92ZUNsYXNzKCdhY3RpdmUnKS5zbGlkZVVwKCk7XHJcbiAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgIGFsbFBhbmVscy5yZW1vdmVDbGFzcygnYWN0aXZlJykuc2xpZGVVcCgpO1xyXG4gICAgICAgICAgICAgICR0aGlzLmFkZENsYXNzKCdhY3RpdmUnKTtcclxuICAgICAgICAgICAgICAkdGFyZ2V0LmFkZENsYXNzKCdhY3RpdmUnKS5zbGlkZURvd24oKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgfSk7XHJcbiAgfSkoalF1ZXJ5KTtcclxufSk7Il19
